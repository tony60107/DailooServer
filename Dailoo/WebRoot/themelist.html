<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="user-scalable=no"/>
    <title>鹿野帶路語音導覽 主選單</title>
    <link rel="shortcut icon" href="images/general/dailoo.png">
    <meta name="Keywords" content="Dailoo, 帶路, 鹿野, 語音導覽, 導覽, 導遊, 高台散步, 鹿野品茶, 龍田逛逛">
    <meta name="Description" content="鹿野週邊語音導覽服務 - 就像導遊親自為您解說">
    <link rel="stylesheet" href="css/base.css"/>
    <link rel="stylesheet" href="css/themelist.css"/>
    <style>
    </style>
</head>
<body>
<div class="w">
    <div class="header clearfix">
        <img class="logo fl" src="images/themelist/logo.png">
        <div id="title" class="cover fl"></div>
    </div>

    <div id="themelist" class="themelist clearfix">

    </div>
    <div id="themelistFill"></div>
</div>
<iframe src="footer.html" id="footerIframe" width="100%" height="0" marginwidth="0" marginheight="0"
        scrolling="No" frameborder="0" style="margin-top: 96px;"></iframe>
</body>
</html>
<script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="js/base.js"></script>
<script type="text/javascript">

    var regionId = location.href.split("id=")[1];
    //if(typeof regionId == 'undefined'){location.href = "/themelist.html?id=e3cfc0f0-a9f5-439b-a534-efff46ced2ce"}

    window.onload = function() {
        $$("footerIframe").contentWindow.changeCss("#EEB962");
    }

    $.ajax({
        url: "/ThemeServlet", context: document.body,
        type: "POST",
        data: {"method": "getThemesByRegionId", "regionId": regionId},
        success: function (data) {
            var themes = eval("(" + data + ")");
            console.dir(data);
            $$("themelist").innerHTML = "";
            for (var i = 0; i < themes.length; i++) {
                var title = themes[i].name.split(",");
                var dom = '<a href="viewlist.html?id=' + themes[i].id + '">' +
                        '<div class="theme" style="top: ' + parseInt(i * 352) + 'px">' +
                        '<div class="cover">' +
                        '<div class="title">' + title[0] + '</div>' +
                        '<div class="title-eng">' + title[1] + '</div>' +
                        '</div>' +
                        '<img alt="" src="/ResourceServlet?url=' + themes[i].behalfPhotoUrl + '"/>' +
                        '</div>' +
                        '</a>';
                $$("themelist").innerHTML = $$("themelist").innerHTML + dom;
                $$("themelistFill").style.height = ((i+1) * 352) + 144 + "px";
            }
        },
    });

    $.ajax({
        url: "/RegionServlet", context: document.body,
        type: "POST",
        data: {"method": "getRegionById", "id": regionId},
        success: function (data) {
            var region = eval("(" + data + ")");
            $$("title").innerHTML = region.name + "周邊導覽";
        },
    });

    history.replaceState(null, null, location.href);

    //Google Analytics程式碼
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
        a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-102968998-1', 'auto');
    ga('send', 'pageview');
</script>