<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>編輯主題</title>
    <!-- 最新編譯和最佳化的 CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <!-- 選擇性佈景主題 -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap-theme.min.css">
    <script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>
    <!-- 最新編譯和最佳化的 JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="css/base.css">
    <style>
        /*主題列表開始*/
        .themelist {
            margin-top: 52px;
            margin-left: 13px;
            margin-right: 12px;
            margin-bottom: 60px;
            width: 935px;
        }

        .theme {
            position: relative;
        }

        .theme .cover {
            position: absolute;
            background: rgba(0,0,0,0.2);
            width: 100%;
            text-align: center;
            top: 72px;
        }

        .theme .cover .title {
            font-size: 72px;
            line-height: 142px;
            color: #FFF;
            letter-spacing: 25px;
        }

        /*.theme .cover .desc {
            font-size: 36px;
            line-height: 36px;
            color: #FFF;
            margin-top: 18px;
            margin-bottom: 18px;
            letter-spacing: 2px;
        }*/

        .themelist .theme {
            margin-top: 47px;
        }

        .themelist .theme img {
            width: 936px;
            height: 284px;
        }
    </style>
</head>
<body>
<div class="w">
    <div><a href="/addViewpoint.html">新增景點</a></div>
    <div><a href="/editRegion.html">地區管理頁面</a></div>
    <div><a href="/editThemes.html">主題管理頁面</a></div>
    <div><a href="/viewpointManager.html">景點管理頁面</a></div>
    <div><a href="/speakersManager.html">講者管理頁面</a></div>
    <div><a href="/LogoutServlet">登出</a></div>
    <form id="mainForm" action="/ThemeServlet?method=addTheme" method="post" enctype="multipart/form-data" style="margin-top: 100px;">
        <div class="form-group">
            <label>地區</label>
            <select id="regionSelect" type="text" name="regionId" class="form-control"></select>
        </div>
        <div class="form-group">
            <label>主題代表圖</label>
            <input type="file" name="file1" class="form-control"/>
        </div>
        <div class="form-group">
            <label>主題名稱</label>
            <input type="text" name="name" class="form-control"/>
        </div>
        <button class="btn btn-warning" type="submit" value="">新增</button>
    </form>
    <div id="themelist" class="themelist">
    </div>
</div>
</body>
</html>
<script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="js/base.js"></script>
<script>

    //獲取所有的地區，以取得地區下所有的主題
    $.ajax({
        url: "/RegionServlet", context: document.body,
        type: "POST",
        data: {"method": "getAllRegions"},
        success: function (data) {
            var regions = eval("(" + data + ")");
            console.dir(data);
            for(var i = 0; i < regions.length; i++){
                var dom = '<option value="'+ regions[i].id +'">' + regions[i].name +'</option>';
                $$("regionSelect").innerHTML = $$("regionSelect").innerHTML + dom;
            }
            $$("regionSelect").onchange();
        },
    });

    $$("regionSelect").onchange = function() {
        $.ajax({
            url: "/ThemeServlet", context: document.body,
            type: "POST",
            data: {"method": "getThemesByRegionId", "regionId": $$("regionSelect").value},
            success: function (data) {
                var themes = eval("(" + data + ")");
                console.dir(data);
                $$("themelist").innerHTML = "";
                for (var i = 0; i < themes.length; i++) {
                    var dom = '<a href="viewlist2.html?id=' + themes[i].id + '">' +
                            '<div class="theme">' +
                            '<div class="cover">' +
                            '<div class="title">' + themes[i].name + '</div>' +
                            '</div>' +
                            '<img alt="無" src="/ResourceServlet?url=' + themes[i].behalfPhotoUrl + '"/>' +
                            '</div>' +
                            '</a>' +
                            '<a href="/updateThemeInfo.html?id='+ themes[i].id +'"><button class="btn btn-warning fr">更新上方主題資訊</button></a>' +
                            '<a href="/ThemeServlet?method=delThemeById&id='+ themes[i].id +'"><button class="btn btn-danger fr">刪除上方主題</button></a>';
                    $$("themelist").innerHTML = $$("themelist").innerHTML + dom;
                }
            },
        });
    }
</script>